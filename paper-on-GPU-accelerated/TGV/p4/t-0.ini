[backend]
precision = double
rank-allocator = linear

[backend-cuda]
device-id = local-rank

[backend-hip]
device-id = local-rank


[constants]
gamma = 1.4
mu = 7.395099728874521e-05
Pr = 0.71

M=0.1

[solver]
system = navier-stokes
order = 4

[solver-time-integrator]
scheme = sdirk43
pseudo-scheme = rk45
controller = none
pseudo-controller = local-pi

tstart            = 0.0
tend              = 20.0



dt = 0.0001
atol = 0.000001
rtol = 0.000001
safety-fact = 0.9
min-fact = 0.3
max-fact = 2.5

[solver-interfaces]
riemann-solver = rusanov
ldg-beta = 0.5
ldg-tau = 0.1

[solver-interfaces-quad]
flux-pts = gauss-legendre

[solver-elements-hex]
soln-pts = gauss-legendre

[soln-ics]
u    = +0.118321595661992*sin(x)*cos(y)*cos(z)
v    = -0.118321595661992*cos(x)*sin(y)*cos(z)
w    = 0.0
p    = 1.0+1.0*0.118321595661992*0.118321595661992/16*(cos(2*x)+cos(2*y))*(cos(2*z)+2)
rho  = (1.0+1.0*0.118321595661992*0.118321595661992/16*(cos(2*x)+cos(2*y))*(cos(2*z)+2))/1.0

[soln-plugin-integrate]
nsteps = 50
file = integral.csv
quad-deg = 4
header = true
vor1 = (grad_w_y - grad_v_z)
vor2 = (grad_u_z - grad_w_x)
vor3 = (grad_v_x - grad_u_y)

int-E = (u*u + v*v + w*w)
int-enst = (%(vor1)s*%(vor1)s + %(vor2)s*%(vor2)s + %(vor3)s*%(vor3)s)
int-diva = abs(grad_u_x + grad_v_y + grad_w_z)

[soln-plugin-dtstats]
flushsteps = 100
file = dtstats.csv
header = true

