[backend]
precision = single
rank-allocator = linear
[backend-cuda]
device-id = local-rank
mpi-type = cuda-aware
block-1d = 64
block-2d = 128
[backend-hip]
device-id = local-rank

[constants]
nu = 6.25e-4
Pc = 111.607
ac-zeta = 4
U       = 1
L       = 1

[solver]
system = ac-navier-stokes
order = 4

[solver-time-integrator]
formulation        = dual
scheme             = sdirk33
pseudo-scheme      = rk45
controller         = none
pseudo-controller  = local-pi
tstart             = 0.0
tend               = 11
dt                 = 0.04
pseudo-dt          = 0.004
pseudo-niters-min  = 1
pseudo-niters-max  = 50
pseudo-resid-norm  = l2
pseudo-resid-tol   = 2e-04
pseudo-resid-tol-p = 0.5
atol               = 1e-5

[solver-dual-time-integrator-multip]
pseudo-dt-fact = 1.75
cycle = [(4, 1), (3, 1), (2, 1), (1, 1), (0, 4), (1, 2), (2, 2), (3, 2), (4, 6), ]

[solver-interfaces]
riemann-solver = rusanov
ldg-beta = 0.5
ldg-tau = 0.1
[solver-interfaces-quad]
flux-pts = gauss-legendre
[solver-elements-hex]
soln-pts = gauss-legendre
[soln-ics]
u    = +0.118321595661992*sin(x)*cos(y)*cos(z)
v    = -0.118321595661992*cos(x)*sin(y)*cos(z)
w    = 0.0
p    = 1.0+1.0*0.118321595661992*0.118321595661992/16*(cos(2*x)+cos(2*y))*(cos(2*z)+2)
rho  = (1.0+1.0*0.118321595661992*0.118321595661992/16*(cos(2*x)+cos(2*y))*(cos(2*z)+2))/1.0
[soln-plugin-integrate]
nsteps = 100
file = integral-sdirk33-dt0-04-single.csv
quad-deg = 4
header = true
vor1 = (grad_w_y - grad_v_z)
vor2 = (grad_u_z - grad_w_x)
vor3 = (grad_v_x - grad_u_y)

int-E = (u*u + v*v + w*w)
int-enst = (%(vor1)s*%(vor1)s + %(vor2)s*%(vor2)s + %(vor3)s*%(vor3)s)
int-diva = abs(grad_u_x + grad_v_y + grad_w_z)

[soln-plugin-pseudostats]
flushsteps = 100
file = pseudostats-sdirk33-dt0-04-single.csv
header = true
